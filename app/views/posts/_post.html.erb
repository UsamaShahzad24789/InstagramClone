<div class="post" id="onePost-<%=post.id%>">
  <div>
    <%if post.image.attached?%>
      <%if  post.image.content_type.include?("image")%>
      <%=image_tag post.image.representation(resize_to_limit: [400, 400]), class:"img", id:"oneImg" ,:"data-postId"=>post.id%>
      <% else %>
        <%=video_tag url_for(post.image),controls: true,width: "400",height: "auto",class:"img",id:"oneVideo",:"data-postId"=>post.id%>
      <% end %>
    <%end%>
  </div>
  <div>
    <p>"<%=post.caption%>" Location: <%=post.location%></p>
  </div>
  <div>
    <%=link_to "Likes: #{post.likes_count}",post_likes_path(post),data:{turbo_frame: "likes"},class:"btn btn primary"%>
  <%=link_to "Comments: #{post.comment_count}",post_comments_path(post),data:{turbo_frame: "postComments"},class:"btn btn primary"%>
  <%=link_to "Archive Post",archives_archive_post_post_path(post),class:"btn btn-outline-danger"%>
  </div>
</div>
<style>
  .post
  {
    padding: 20px;
  }
</style>
<script>
      //open a modal with edit and delete by clicking on any post
      var myModal = document.getElementById('exampleModal')
      a=document.getElementsByClassName("img")
      myModal.hidden= true
      Object.keys(a).forEach((x)=>{a[x].addEventListener('click',(e)=>{
          myModal.hidden= false
          b=a[x].dataset.postid
          const btn=document.getElementById("deleteBtn")
          btn.addEventListener('click',()=>{
            $.ajax({
                  url: '/posts/destroy',
                  method: 'DELETE',
                  data: {post_id: b},
                  success: function(data){

                  }
            })
          })
          const editBtn=document.getElementById("editBtn")
          const editPost=document.getElementById("editPost")
          editPost.hidden=true
          editBtn.addEventListener('click',(e)=>{
            editPost.hidden=false
            editPost.click()
            editPost.setAttribute("href","/posts/"+b+"/edit")
          })
      })})
      // window.onclick = function(event) {
      //     if (event.target.id != "exampleModal" && event.target.id != "oneImg" && event.target.id != "editBtn") {
      //           myModal.hidden= true
      //     }
      //   }
  </script>
